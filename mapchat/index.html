<!DOCTYPE html>
<html>
	<head>
		<title>Assignment 2 - Comp 20</title> 
		<link rel="stylesheet" type="text/css" href="style.css">
		<script src="http://maps.google.com/maps/api/js?sensor=true"></script>
		<script>
			var map; 
			var my_lat = 0;
			var my_lng = 0;
			var myLocation = new google.maps.LatLng(my_lat, my_lng); 
			var locationMarker; 
			var info; 
			var xhr; 

			function init() {
				map = new google.maps.Map(document.getElementById('map'), {
 					center: myLocation,
					zoom: 15 }); 
				getCurrentLocation(); 
				parseData(); 
			}

			function getCurrentLocation(){
				if (navigator.geolocation){
					navigator.geolocation.getCurrentPosition(function(position) {
 						my_lat = position.coords.latitude
 						my_lng = position.coords.longitude;
 						showMap(); 
					}); 	
				}

				else {
					alert("Sorry, geolocation is not supported on your browser.");
				}
			}

			function showMap() {
				myLocation = new google.maps.LatLng(my_lat, my_lng);
				map.panTo(myLocation); 

				var img = '8th notes.jpg';
				
				//Source: https://developers.google.com/maps/documentation/javascript/markers
				locationMarker = new google.maps.Marker({
					position: myLocation,
					map: map,
					title: 'My Location',
					icon: img,
				});

				//Source: https://developers.google.com/maps/documentation/javascript/infowindows
				info = new google.maps.InfoWindow({
					content: 'LisaLytle'
				});

				locationMarker.addListener('click', function(){
					info.open(map, locationMarker); 
				});
			}

			function parseData () {
				xhr = new XMLHttpRequest(); 
				var url = 'https://secret-about-box.herokuapp.com/sendLocation'; 

				xhr.open("POST", url, true); 
				xhr.setRequestHeader("Content-type", "application/x-www-form-urlencoded"); 

				xhr.send("login=LisaLytle&lat=YOUR_LATITUDE&lng=YOUR_LONGITUDE&message=YOUR_MESSAGE"); //?????
			}
		</script> 
	</head>

	<body onload ="init()">
		<div id ="map"></div> 
	</body>
</html>